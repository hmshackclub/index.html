<html>
  <head>
    <title>My page title</title>
      <meta name="description" content="Zombie map within Whangamata">
      <meta name="keywords" content="Zombie, Whangamata, map">
      <meta name="author" content="Ian Fulton">
      
    <nav class="controls">
			<a href="#" class="button" onClick="stopwatch.start();">Start</a>
			<a href="#" class="button" 
    
      <style>
 {
    height: 100%;
    width: 100%;
    left: 0;
    position: absolute;
    top: 0;  
    background-color: grey;
}
</style>
  </head>
    
  
  <body style="background-color:#9BDCB7;">
    <div id="zombie_map"></div>
      
      <form>
      <!--Select an emoji-->
        <select id="icon_to_use">
            <option value=“zombie.png">Zombie</option>
            <option value=“2694.png">Swords</option>
            <option value="hospital_1f3e5.pn.png">Hospital</option>
        </select>
      </form>
      
    
    <script>
    var zombie_map;
    var score = 0;
    var tolerance = 1;
    var old_position;
    var all_markers = [];
    var data = `37.841519 -122.232422 zombie.png
            37.841332 -122.232343 zombie.png 
            37.841339 -122.232430 zombie.png
            37.839356 -122.232450 zombie.png
            37.841038 -122.232862 zombie.png
            37.840911 -122.232969 zombie.png
            37.840921 -122.233013 zombie.png
            37.840956 -122.232865 zombie.png
            37.840984 -122.232949 zombie.png
            37.840963 -122.232865 zombie.png
            37.840956 -122.232815 zombie.png
            37.840986 -122.232868 zombie.png
            37.840986 -122.232868 zombie.png
            37.841014 -122.232809 zombie.png
            37.841061 -122.232710 zombie.png
            37.840877 -122.232983 zombie.png
            37.840873 -122.232917 zombie.png
            37.840873 -122.232917 zombie.png
            37.840873 -122.232917 zombie.png
            37.841103 -122.232619 swords.png
            37.832201 -122.233619 swords.png
            37.841289 -122.232585 hospital.png`;
    var markers = data.split("\n");
    
    function initMap() {
        zombie_map = new google.maps.Map(document.getElementById('zombie_map'), {zoom: 19,center: {lat: 37.841277, lng: -122.232438}
        });    
        
        old_position = new google.maps.Marker({
        position: {lat: 37.841277, lng: -122.232438},
        map: zombie_map,
        });
        
        for (var i = 0; i < markers.length; i++) {
            var marker_data = markers[i].trim();
            marker_data = marker_data.split(" ");
            var latitude = marker_data[0];
            var longitude = marker_data[1];
            var emoji = marker_data[2];
            var marker_position = new google.maps.LatLng(latitude, longitude);
            var marker = new google.maps.Marker({
                position: marker_position,
                map: zombie_map,
                icon: emoji
            });
            all_markers.push(marker);
        }
       
        if(navigator.geolocation) {
    navigator.geolocation.watchPosition(set_my_position);
}
else {
    alert("Geolocation doesn't work in your browser");
}
       }   
    
    function set_my_position(position){
        old_position.setMap(null);
        
        var pos = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
        var marker = new google.maps.Marker({
                position: pos,
                map: zombie_map
            });
        
        old_position = marker;
        for (var i = 0; i < all_markers.length; i++) {
            var distance = google.maps.geometry.spherical.computeDistanceBetween(pos, all_markers[i].getPosition());
        if(distance < tolerance){
            var what_is_it = all_markers[i].getIcon();
            what_is_it = what_is_it.replace(".png", "");
            alert("Found the " + what_is_it );
            all_markers[i].setMap(null);
          
            if (what_is_it == "zombie") {
              alert("roawr roar growl, you've ran into a zombie!");
              score -= 300;
              
            else if (what_is_it == ("diamond") {
              alert("Ooo shoot, a DIAMOND!");
              score += 450;
              
              class Stopwatch {
    constructor(display, results) {
        this.running = false;
        this.display = display;
        this.results = results;
        this.laps = [];
        this.reset();
        this.print(this.times);
    }
    
    reset() {
        this.times = [ 0, 0, 0 ];
    }
    
    start() {
        if (!this.time) this.time = performance.now();
        if (!this.running) {
            this.running = true;
            requestAnimationFrame(this.step.bind(this));
        }
    }
    
    lap() {
        let times = this.times;
        let li = document.createElement('li');
        li.innerText = this.format(times);
        this.results.appendChild(li);
    }
    
    stop() {
        this.running = false;
        this.time = null;
    }

    restart() {
        if (!this.time) this.time = performance.now();
        if (!this.running) {
            this.running = true;
            requestAnimationFrame(this.step.bind(this));
        }
        this.reset();
    }
    
    clear() {
        clearChildren(this.results);
    }
    
    step(timestamp) {
        if (!this.running) return;
        this.calculate(timestamp);
        this.time = timestamp;
        this.print();
        requestAnimationFrame(this.step.bind(this));
    }
    
    calculate(timestamp) {
        var diff = timestamp - this.time;
        // Hundredths of a second are 100 ms
        this.times[2] += diff / 10;
        // Seconds are 100 hundredths of a second
        if (this.times[2] >= 100) {
            this.times[1] += 1;
            this.times[2] -= 100;
        }
        // Minutes are 60 seconds
        if (this.times[1] >= 60) {
            this.times[0] += 1;
            this.times[1] -= 60;
        }
    }
    
    print() {
        this.display.innerText = this.format(this.times);
    }
    
    format(times) {
        return `\
${pad0(times[0], 2)}:\
${pad0(times[1], 2)}:\
${pad0(Math.floor(times[2]), 2)}`;
    }
}

function pad0(value, count) {
    var result = value.toString();
    for (; result.length < count; --count)
        result = '0' + result;
    return result;
}

function clearChildren(node) {
    while (node.lastChild)
        node.removeChild(node.lastChild);
}

let stopwatch = new Stopwatch(
    document.querySelector('.stopwatch'),
    document.querySelector('.results'));
          }
    }
          
    }
    </script>
      
      <script async defer
              src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBbufLlbULm6C7oTMq8X_aEIsuPbuduMOE&callback=initMap&libraries=geometry">
      </script>    
  </body>
</html>
